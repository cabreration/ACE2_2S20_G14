function cov_24tl83nxh5(){var path="C:\\Users\\arnol\\Documents\\GitHub\\practica2_g6\\backend\\app\\controllers\\producto.js";var hash="f24fa77c4e98a8c0c933275dafab65774496d9dd";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\arnol\\Documents\\GitHub\\practica2_g6\\backend\\app\\controllers\\producto.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:31}},"1":{start:{line:2,column:17},end:{line:2,column:28}},"2":{start:{line:4,column:0},end:{line:4,column:28}},"3":{start:{line:7,column:0},end:{line:33,column:2}},"4":{start:{line:9,column:4},end:{line:11,column:5}},"5":{start:{line:10,column:8},end:{line:10,column:100}},"6":{start:{line:13,column:4},end:{line:32,column:11}},"7":{start:{line:22,column:12},end:{line:27,column:13}},"8":{start:{line:23,column:16},end:{line:26,column:19}},"9":{start:{line:28,column:12},end:{line:31,column:15}},"10":{start:{line:36,column:0},end:{line:60,column:2}},"11":{start:{line:37,column:19},end:{line:37,column:36}},"12":{start:{line:39,column:4},end:{line:43,column:5}},"13":{start:{line:40,column:8},end:{line:42,column:11}},"14":{start:{line:45,column:4},end:{line:59,column:7}},"15":{start:{line:46,column:8},end:{line:51,column:9}},"16":{start:{line:47,column:12},end:{line:50,column:15}},"17":{start:{line:52,column:8},end:{line:56,column:9}},"18":{start:{line:53,column:12},end:{line:55,column:15}},"19":{start:{line:58,column:8},end:{line:58,column:30}},"20":{start:{line:63,column:0},end:{line:97,column:2}},"21":{start:{line:64,column:4},end:{line:68,column:5}},"22":{start:{line:65,column:8},end:{line:67,column:11}},"23":{start:{line:70,column:19},end:{line:70,column:36}},"24":{start:{line:72,column:4},end:{line:76,column:5}},"25":{start:{line:73,column:8},end:{line:75,column:11}},"26":{start:{line:78,column:4},end:{line:96,column:11}},"27":{start:{line:80,column:12},end:{line:84,column:13}},"28":{start:{line:81,column:16},end:{line:83,column:19}},"29":{start:{line:86,column:12},end:{line:89,column:15}},"30":{start:{line:92,column:12},end:{line:95,column:15}},"31":{start:{line:100,column:0},end:{line:127,column:2}},"32":{start:{line:101,column:19},end:{line:101,column:36}},"33":{start:{line:103,column:4},end:{line:107,column:5}},"34":{start:{line:104,column:8},end:{line:106,column:11}},"35":{start:{line:109,column:4},end:{line:126,column:11}},"36":{start:{line:111,column:12},end:{line:115,column:13}},"37":{start:{line:112,column:16},end:{line:114,column:19}},"38":{start:{line:117,column:12},end:{line:119,column:15}},"39":{start:{line:122,column:12},end:{line:125,column:15}},"40":{start:{line:130,column:0},end:{line:141,column:2}},"41":{start:{line:131,column:4},end:{line:140,column:11}},"42":{start:{line:133,column:12},end:{line:133,column:34}},"43":{start:{line:136,column:12},end:{line:139,column:15}},"44":{start:{line:144,column:0},end:{line:191,column:2}},"45":{start:{line:145,column:4},end:{line:149,column:5}},"46":{start:{line:146,column:8},end:{line:148,column:11}},"47":{start:{line:150,column:21},end:{line:151,column:26}},"48":{start:{line:153,column:4},end:{line:157,column:5}},"49":{start:{line:154,column:8},end:{line:156,column:11}},"50":{start:{line:158,column:4},end:{line:190,column:11}},"51":{start:{line:177,column:12},end:{line:182,column:13}},"52":{start:{line:178,column:16},end:{line:181,column:19}},"53":{start:{line:183,column:12},end:{line:183,column:34}},"54":{start:{line:186,column:12},end:{line:189,column:15}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:31},end:{line:33,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:8},end:{line:21,column:9}},loc:{start:{line:21,column:26},end:{line:32,column:9}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:36,column:18},end:{line:36,column:19}},loc:{start:{line:36,column:32},end:{line:60,column:1}},line:36},"3":{name:"(anonymous_3)",decl:{start:{line:45,column:38},end:{line:45,column:39}},loc:{start:{line:45,column:58},end:{line:59,column:5}},line:45},"4":{name:"(anonymous_4)",decl:{start:{line:63,column:17},end:{line:63,column:18}},loc:{start:{line:63,column:31},end:{line:97,column:1}},line:63},"5":{name:"(anonymous_5)",decl:{start:{line:79,column:14},end:{line:79,column:15}},loc:{start:{line:79,column:22},end:{line:90,column:9}},line:79},"6":{name:"(anonymous_6)",decl:{start:{line:91,column:15},end:{line:91,column:16}},loc:{start:{line:91,column:22},end:{line:96,column:9}},line:91},"7":{name:"(anonymous_7)",decl:{start:{line:100,column:17},end:{line:100,column:18}},loc:{start:{line:100,column:31},end:{line:127,column:1}},line:100},"8":{name:"(anonymous_8)",decl:{start:{line:110,column:14},end:{line:110,column:15}},loc:{start:{line:110,column:22},end:{line:120,column:9}},line:110},"9":{name:"(anonymous_9)",decl:{start:{line:121,column:15},end:{line:121,column:16}},loc:{start:{line:121,column:22},end:{line:126,column:9}},line:121},"10":{name:"(anonymous_10)",decl:{start:{line:130,column:17},end:{line:130,column:18}},loc:{start:{line:130,column:32},end:{line:141,column:1}},line:130},"11":{name:"(anonymous_11)",decl:{start:{line:132,column:14},end:{line:132,column:15}},loc:{start:{line:132,column:22},end:{line:134,column:9}},line:132},"12":{name:"(anonymous_12)",decl:{start:{line:135,column:15},end:{line:135,column:16}},loc:{start:{line:135,column:22},end:{line:140,column:9}},line:135},"13":{name:"(anonymous_13)",decl:{start:{line:144,column:15},end:{line:144,column:16}},loc:{start:{line:144,column:29},end:{line:191,column:1}},line:144},"14":{name:"(anonymous_14)",decl:{start:{line:176,column:14},end:{line:176,column:15}},loc:{start:{line:176,column:22},end:{line:184,column:9}},line:176},"15":{name:"(anonymous_15)",decl:{start:{line:185,column:15},end:{line:185,column:16}},loc:{start:{line:185,column:22},end:{line:190,column:9}},line:185}},branchMap:{"0":{loc:{start:{line:9,column:4},end:{line:11,column:5}},type:"if",locations:[{start:{line:9,column:4},end:{line:11,column:5}},{start:{line:9,column:4},end:{line:11,column:5}}],line:9},"1":{loc:{start:{line:9,column:8},end:{line:9,column:66}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:24}},{start:{line:9,column:28},end:{line:9,column:46}},{start:{line:9,column:50},end:{line:9,column:66}}],line:9},"2":{loc:{start:{line:17,column:25},end:{line:17,column:66}},type:"binary-expr",locations:[{start:{line:17,column:25},end:{line:17,column:45}},{start:{line:17,column:49},end:{line:17,column:66}}],line:17},"3":{loc:{start:{line:18,column:18},end:{line:18,column:37}},type:"binary-expr",locations:[{start:{line:18,column:18},end:{line:18,column:31}},{start:{line:18,column:35},end:{line:18,column:37}}],line:18},"4":{loc:{start:{line:22,column:12},end:{line:27,column:13}},type:"if",locations:[{start:{line:22,column:12},end:{line:27,column:13}},{start:{line:22,column:12},end:{line:27,column:13}}],line:22},"5":{loc:{start:{line:24,column:32},end:{line:24,column:49}},type:"binary-expr",locations:[{start:{line:24,column:32},end:{line:24,column:43}},{start:{line:24,column:47},end:{line:24,column:49}}],line:24},"6":{loc:{start:{line:39,column:4},end:{line:43,column:5}},type:"if",locations:[{start:{line:39,column:4},end:{line:43,column:5}},{start:{line:39,column:4},end:{line:43,column:5}}],line:39},"7":{loc:{start:{line:39,column:8},end:{line:39,column:50}},type:"binary-expr",locations:[{start:{line:39,column:8},end:{line:39,column:27}},{start:{line:39,column:31},end:{line:39,column:50}}],line:39},"8":{loc:{start:{line:46,column:8},end:{line:51,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:51,column:9}},{start:{line:46,column:8},end:{line:51,column:9}}],line:46},"9":{loc:{start:{line:49,column:28},end:{line:49,column:45}},type:"binary-expr",locations:[{start:{line:49,column:28},end:{line:49,column:39}},{start:{line:49,column:43},end:{line:49,column:45}}],line:49},"10":{loc:{start:{line:52,column:8},end:{line:56,column:9}},type:"if",locations:[{start:{line:52,column:8},end:{line:56,column:9}},{start:{line:52,column:8},end:{line:56,column:9}}],line:52},"11":{loc:{start:{line:64,column:4},end:{line:68,column:5}},type:"if",locations:[{start:{line:64,column:4},end:{line:68,column:5}},{start:{line:64,column:4},end:{line:68,column:5}}],line:64},"12":{loc:{start:{line:64,column:8},end:{line:64,column:109}},type:"binary-expr",locations:[{start:{line:64,column:8},end:{line:64,column:24}},{start:{line:64,column:28},end:{line:64,column:46}},{start:{line:64,column:50},end:{line:64,column:71}},{start:{line:64,column:75},end:{line:64,column:89}},{start:{line:64,column:93},end:{line:64,column:109}}],line:64},"13":{loc:{start:{line:72,column:4},end:{line:76,column:5}},type:"if",locations:[{start:{line:72,column:4},end:{line:76,column:5}},{start:{line:72,column:4},end:{line:76,column:5}}],line:72},"14":{loc:{start:{line:72,column:8},end:{line:72,column:50}},type:"binary-expr",locations:[{start:{line:72,column:8},end:{line:72,column:27}},{start:{line:72,column:31},end:{line:72,column:50}}],line:72},"15":{loc:{start:{line:80,column:12},end:{line:84,column:13}},type:"if",locations:[{start:{line:80,column:12},end:{line:84,column:13}},{start:{line:80,column:12},end:{line:84,column:13}}],line:80},"16":{loc:{start:{line:94,column:28},end:{line:94,column:45}},type:"binary-expr",locations:[{start:{line:94,column:28},end:{line:94,column:39}},{start:{line:94,column:43},end:{line:94,column:45}}],line:94},"17":{loc:{start:{line:103,column:4},end:{line:107,column:5}},type:"if",locations:[{start:{line:103,column:4},end:{line:107,column:5}},{start:{line:103,column:4},end:{line:107,column:5}}],line:103},"18":{loc:{start:{line:103,column:8},end:{line:103,column:50}},type:"binary-expr",locations:[{start:{line:103,column:8},end:{line:103,column:27}},{start:{line:103,column:31},end:{line:103,column:50}}],line:103},"19":{loc:{start:{line:111,column:12},end:{line:115,column:13}},type:"if",locations:[{start:{line:111,column:12},end:{line:115,column:13}},{start:{line:111,column:12},end:{line:115,column:13}}],line:111},"20":{loc:{start:{line:124,column:28},end:{line:124,column:45}},type:"binary-expr",locations:[{start:{line:124,column:28},end:{line:124,column:39}},{start:{line:124,column:43},end:{line:124,column:45}}],line:124},"21":{loc:{start:{line:138,column:28},end:{line:138,column:45}},type:"binary-expr",locations:[{start:{line:138,column:28},end:{line:138,column:39}},{start:{line:138,column:43},end:{line:138,column:45}}],line:138},"22":{loc:{start:{line:145,column:4},end:{line:149,column:5}},type:"if",locations:[{start:{line:145,column:4},end:{line:149,column:5}},{start:{line:145,column:4},end:{line:149,column:5}}],line:145},"23":{loc:{start:{line:153,column:4},end:{line:157,column:5}},type:"if",locations:[{start:{line:153,column:4},end:{line:157,column:5}},{start:{line:153,column:4},end:{line:157,column:5}}],line:153},"24":{loc:{start:{line:177,column:12},end:{line:182,column:13}},type:"if",locations:[{start:{line:177,column:12},end:{line:182,column:13}},{start:{line:177,column:12},end:{line:182,column:13}}],line:177},"25":{loc:{start:{line:188,column:28},end:{line:188,column:45}},type:"binary-expr",locations:[{start:{line:188,column:28},end:{line:188,column:39}},{start:{line:188,column:43},end:{line:188,column:45}}],line:188}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0,0,0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"f24fa77c4e98a8c0c933275dafab65774496d9dd"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_24tl83nxh5=function(){return actualCoverage;};}return actualCoverage;}cov_24tl83nxh5();const db=(cov_24tl83nxh5().s[0]++,require("../models"));const Producto=(cov_24tl83nxh5().s[1]++,db.producto);cov_24tl83nxh5().s[2]++;exports.Producto=Producto;// Crear y guardar un producto
cov_24tl83nxh5().s[3]++;exports.create=(req,res)=>{cov_24tl83nxh5().f[0]++;cov_24tl83nxh5().s[4]++;if((cov_24tl83nxh5().b[1][0]++,!req.body.nombre)||(cov_24tl83nxh5().b[1][1]++,!req.body.vendedor)||(cov_24tl83nxh5().b[1][2]++,!req.body.precio)){cov_24tl83nxh5().b[0][0]++;cov_24tl83nxh5().s[5]++;return res.status(400).json({message:"Los datos enviados del producto son incorrectos"});}else{cov_24tl83nxh5().b[0][1]++;}cov_24tl83nxh5().s[6]++;Producto.create({nombre:req.body.nombre,vendedor:req.body.vendedor,precio:req.body.precio,descripcion:(cov_24tl83nxh5().b[2][0]++,req.body.descripcion)||(cov_24tl83nxh5().b[2][1]++,"No categorizado"),tags:(cov_24tl83nxh5().b[3][0]++,req.body.tags)||(cov_24tl83nxh5().b[3][1]++,[])},// callback
(err,product)=>{cov_24tl83nxh5().f[1]++;cov_24tl83nxh5().s[7]++;if(err){cov_24tl83nxh5().b[4][0]++;cov_24tl83nxh5().s[8]++;return res.status(500).json({db_message:(cov_24tl83nxh5().b[5][0]++,err.message)||(cov_24tl83nxh5().b[5][1]++,""),message:"Error al agregar producto"});}else{cov_24tl83nxh5().b[4][1]++;}cov_24tl83nxh5().s[9]++;return res.status(201).json({producto:product,message:"Creado"});});};// Obtener un producto con su codigo
cov_24tl83nxh5().s[10]++;exports.findOne=(req,res)=>{cov_24tl83nxh5().f[2]++;const codigo=(cov_24tl83nxh5().s[11]++,req.params.codigo);cov_24tl83nxh5().s[12]++;if((cov_24tl83nxh5().b[7][0]++,codigo.length!=24)&&(cov_24tl83nxh5().b[7][1]++,codigo.length!=12)){cov_24tl83nxh5().b[6][0]++;cov_24tl83nxh5().s[13]++;return res.status(400).send({message:"Codigo invalido"});}else{cov_24tl83nxh5().b[6][1]++;}cov_24tl83nxh5().s[14]++;Producto.findOne({_id:codigo},function(err,data){cov_24tl83nxh5().f[3]++;cov_24tl83nxh5().s[15]++;if(err){cov_24tl83nxh5().b[8][0]++;cov_24tl83nxh5().s[16]++;return res.status(500).json({message:"Error al obtener el producto",db_message:(cov_24tl83nxh5().b[9][0]++,err.message)||(cov_24tl83nxh5().b[9][1]++,"")});}else{cov_24tl83nxh5().b[8][1]++;}cov_24tl83nxh5().s[17]++;if(!data){cov_24tl83nxh5().b[10][0]++;cov_24tl83nxh5().s[18]++;return res.status(404).json({message:`El producto ${codigo} no existe`});}else{cov_24tl83nxh5().b[10][1]++;}cov_24tl83nxh5().s[19]++;return res.json(data);});};// Modificar un producto por su codigo
cov_24tl83nxh5().s[20]++;exports.update=(req,res)=>{cov_24tl83nxh5().f[4]++;cov_24tl83nxh5().s[21]++;if((cov_24tl83nxh5().b[12][0]++,!req.body.nombre)&&(cov_24tl83nxh5().b[12][1]++,!req.body.vendedor)&&(cov_24tl83nxh5().b[12][2]++,!req.body.descripcion)&&(cov_24tl83nxh5().b[12][3]++,!req.body.tags)&&(cov_24tl83nxh5().b[12][4]++,!req.body.precio)){cov_24tl83nxh5().b[11][0]++;cov_24tl83nxh5().s[22]++;return res.status(400).send({message:"No se enviaron datos a modificar"});}else{cov_24tl83nxh5().b[11][1]++;}const codigo=(cov_24tl83nxh5().s[23]++,req.params.codigo);cov_24tl83nxh5().s[24]++;if((cov_24tl83nxh5().b[14][0]++,codigo.length!=24)&&(cov_24tl83nxh5().b[14][1]++,codigo.length!=12)){cov_24tl83nxh5().b[13][0]++;cov_24tl83nxh5().s[25]++;return res.status(400).send({message:"Codigo invalido"});}else{cov_24tl83nxh5().b[13][1]++;}cov_24tl83nxh5().s[26]++;Producto.findOneAndUpdate({_id:codigo},req.body,{useFindAndModify:false,new:true}).then(data=>{cov_24tl83nxh5().f[5]++;cov_24tl83nxh5().s[27]++;if(!data){cov_24tl83nxh5().b[15][0]++;cov_24tl83nxh5().s[28]++;return res.status(404).json({message:`El producto ${codigo} no existe`});}else{cov_24tl83nxh5().b[15][1]++;}cov_24tl83nxh5().s[29]++;return res.json({message:'Modificado',producto:data});}).catch(err=>{cov_24tl83nxh5().f[6]++;cov_24tl83nxh5().s[30]++;res.status(500).json({message:`Error modificando el producto ${codigo}`,db_message:(cov_24tl83nxh5().b[16][0]++,err.message)||(cov_24tl83nxh5().b[16][1]++,"")});});};// Elimina un producto por su codigo
cov_24tl83nxh5().s[31]++;exports.delete=(req,res)=>{cov_24tl83nxh5().f[7]++;const codigo=(cov_24tl83nxh5().s[32]++,req.params.codigo);cov_24tl83nxh5().s[33]++;if((cov_24tl83nxh5().b[18][0]++,codigo.length!=24)&&(cov_24tl83nxh5().b[18][1]++,codigo.length!=12)){cov_24tl83nxh5().b[17][0]++;cov_24tl83nxh5().s[34]++;return res.status(400).send({message:"Codigo invalido"});}else{cov_24tl83nxh5().b[17][1]++;}cov_24tl83nxh5().s[35]++;Producto.findOneAndRemove({_id:codigo}).then(data=>{cov_24tl83nxh5().f[8]++;cov_24tl83nxh5().s[36]++;if(!data){cov_24tl83nxh5().b[19][0]++;cov_24tl83nxh5().s[37]++;return res.status(404).send({message:`El producto ${codigo} no existe.`});}else{cov_24tl83nxh5().b[19][1]++;}cov_24tl83nxh5().s[38]++;return res.send({message:`Eliminado`});}).catch(err=>{cov_24tl83nxh5().f[9]++;cov_24tl83nxh5().s[39]++;return res.status(500).json({message:`Error al eliminar el producto ${codigo}`,db_message:(cov_24tl83nxh5().b[20][0]++,err.message)||(cov_24tl83nxh5().b[20][1]++,"")});});};// Obtener todos los productos
cov_24tl83nxh5().s[40]++;exports.getAll=(_req,res)=>{cov_24tl83nxh5().f[10]++;cov_24tl83nxh5().s[41]++;Producto.find({}).then(data=>{cov_24tl83nxh5().f[11]++;cov_24tl83nxh5().s[42]++;return res.json(data);}).catch(err=>{cov_24tl83nxh5().f[12]++;cov_24tl83nxh5().s[43]++;return res.status(500).json({message:"Error al retornar todos los productos en la BD",db_message:(cov_24tl83nxh5().b[21][0]++,err.message)||(cov_24tl83nxh5().b[21][1]++,"")});});};// Buscar producto
cov_24tl83nxh5().s[44]++;exports.find=(req,res)=>{cov_24tl83nxh5().f[13]++;cov_24tl83nxh5().s[45]++;if(req.query.search==undefined){cov_24tl83nxh5().b[22][0]++;cov_24tl83nxh5().s[46]++;return res.status(400).send({message:"La busqueda no puede estar vacia"});}else{cov_24tl83nxh5().b[22][1]++;}const consulta=(cov_24tl83nxh5().s[47]++,req.query.search.replace(/ /g,"|").replace(/,/g,""));cov_24tl83nxh5().s[48]++;if(!consulta){cov_24tl83nxh5().b[23][0]++;cov_24tl83nxh5().s[49]++;return res.status(400).send({message:"La busqueda no puede estar vacia"});}else{cov_24tl83nxh5().b[23][1]++;}cov_24tl83nxh5().s[50]++;Producto.find({$or:[{nombre:{$regex:consulta,$options:"i"}},{vendedor:{$regex:consulta,$options:"i"}},{descripcion:{$regex:consulta,$options:"i"}}]}).then(data=>{cov_24tl83nxh5().f[14]++;cov_24tl83nxh5().s[51]++;if(data.length==0){cov_24tl83nxh5().b[24][0]++;cov_24tl83nxh5().s[52]++;return res.status(404).json({message:`No se encontraron productos con la `+`busqueda "${consulta}"`});}else{cov_24tl83nxh5().b[24][1]++;}cov_24tl83nxh5().s[53]++;return res.json(data);}).catch(err=>{cov_24tl83nxh5().f[15]++;cov_24tl83nxh5().s[54]++;return res.status(500).json({message:"Error al retornar todos los productos en la BD",db_message:(cov_24tl83nxh5().b[25][0]++,err.message)||(cov_24tl83nxh5().b[25][1]++,"")});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3RvLmpzIl0sIm5hbWVzIjpbImRiIiwicmVxdWlyZSIsIlByb2R1Y3RvIiwicHJvZHVjdG8iLCJleHBvcnRzIiwiY3JlYXRlIiwicmVxIiwicmVzIiwiYm9keSIsIm5vbWJyZSIsInZlbmRlZG9yIiwicHJlY2lvIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJkZXNjcmlwY2lvbiIsInRhZ3MiLCJlcnIiLCJwcm9kdWN0IiwiZGJfbWVzc2FnZSIsImZpbmRPbmUiLCJjb2RpZ28iLCJwYXJhbXMiLCJsZW5ndGgiLCJzZW5kIiwiX2lkIiwiZGF0YSIsInVwZGF0ZSIsImZpbmRPbmVBbmRVcGRhdGUiLCJ1c2VGaW5kQW5kTW9kaWZ5IiwibmV3IiwidGhlbiIsImNhdGNoIiwiZGVsZXRlIiwiZmluZE9uZUFuZFJlbW92ZSIsImdldEFsbCIsIl9yZXEiLCJmaW5kIiwicXVlcnkiLCJzZWFyY2giLCJ1bmRlZmluZWQiLCJjb25zdWx0YSIsInJlcGxhY2UiLCIkb3IiLCIkcmVnZXgiLCIkb3B0aW9ucyJdLCJtYXBwaW5ncyI6InlsWUFlWTsyRkFmWixLQUFNQSxDQUFBQSxFQUFFLDBCQUFHQyxPQUFPLENBQUMsV0FBRCxDQUFWLENBQVIsQ0FDQSxLQUFNQyxDQUFBQSxRQUFRLDBCQUFHRixFQUFFLENBQUNHLFFBQU4sQ0FBZCxDLHdCQUVBQyxPQUFPLENBQUNGLFFBQVIsQ0FBbUJBLFFBQW5CLENBRUE7d0JBQ0FFLE9BQU8sQ0FBQ0MsTUFBUixDQUFpQixDQUFDQyxHQUFELENBQU1DLEdBQU4sR0FBYyxpREFFM0IsR0FBSSw2QkFBQ0QsR0FBRyxDQUFDRSxJQUFKLENBQVNDLE1BQVYsK0JBQW9CLENBQUNILEdBQUcsQ0FBQ0UsSUFBSixDQUFTRSxRQUE5QiwrQkFBMEMsQ0FBQ0osR0FBRyxDQUFDRSxJQUFKLENBQVNHLE1BQXBELENBQUosQ0FBZ0Usb0RBQzVELE1BQU9KLENBQUFBLEdBQUcsQ0FBQ0ssTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhC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Q0FBckIsQ0FBUCxDQUlILENBaENMLEVBaUNILENBL0NEIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKFwiLi4vbW9kZWxzXCIpO1xyXG5jb25zdCBQcm9kdWN0byA9IGRiLnByb2R1Y3RvO1xyXG5cclxuZXhwb3J0cy5Qcm9kdWN0byA9IFByb2R1Y3RvO1xyXG5cclxuLy8gQ3JlYXIgeSBndWFyZGFyIHVuIHByb2R1Y3RvXHJcbmV4cG9ydHMuY3JlYXRlID0gKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gICAgaWYgKCFyZXEuYm9keS5ub21icmUgfHwgIXJlcS5ib2R5LnZlbmRlZG9yIHx8ICFyZXEuYm9keS5wcmVjaW8pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcIkxvcyBkYXRvcyBlbnZpYWRvcyBkZWwgcHJvZHVjdG8gc29uIGluY29ycmVjdG9zXCIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUHJvZHVjdG8uY3JlYXRlKHtcclxuICAgICAgICAgICAgbm9tYnJlOiByZXEuYm9keS5ub21icmUsXHJcbiAgICAgICAgICAgIHZlbmRlZG9yOiByZXEuYm9keS52ZW5kZWRvcixcclxuICAgICAgICAgICAgcHJlY2lvOiByZXEuYm9keS5wcmVjaW8sXHJcbiAgICAgICAgICAgIGRlc2NyaXBjaW9uOiByZXEuYm9keS5kZXNjcmlwY2lvbiB8fCBcIk5vIGNhdGVnb3JpemFkb1wiLFxyXG4gICAgICAgICAgICB0YWdzOiByZXEuYm9keS50YWdzIHx8IFtdXHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBjYWxsYmFja1xyXG4gICAgICAgIChlcnIsIHByb2R1Y3QpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICAgICAgICAgICAgICBkYl9tZXNzYWdlOiBlcnIubWVzc2FnZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRXJyb3IgYWwgYWdyZWdhciBwcm9kdWN0b1wiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdG86IHByb2R1Y3QsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkNyZWFkb1wiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG59O1xyXG5cclxuLy8gT2J0ZW5lciB1biBwcm9kdWN0byBjb24gc3UgY29kaWdvXHJcbmV4cG9ydHMuZmluZE9uZSA9IChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3QgY29kaWdvID0gcmVxLnBhcmFtcy5jb2RpZ287XHJcblxyXG4gICAgaWYgKGNvZGlnby5sZW5ndGggIT0gMjQgJiYgY29kaWdvLmxlbmd0aCAhPSAxMikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiQ29kaWdvIGludmFsaWRvXCJcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBQcm9kdWN0by5maW5kT25lKHsgX2lkOiBjb2RpZ28gfSwgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBhbCBvYnRlbmVyIGVsIHByb2R1Y3RvXCIsXHJcbiAgICAgICAgICAgICAgICBkYl9tZXNzYWdlOiBlcnIubWVzc2FnZSB8fCBcIlwiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFbCBwcm9kdWN0byAke2NvZGlnb30gbm8gZXhpc3RlYFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuanNvbihkYXRhKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8gTW9kaWZpY2FyIHVuIHByb2R1Y3RvIHBvciBzdSBjb2RpZ29cclxuZXhwb3J0cy51cGRhdGUgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGlmICghcmVxLmJvZHkubm9tYnJlICYmICFyZXEuYm9keS52ZW5kZWRvciAmJiAhcmVxLmJvZHkuZGVzY3JpcGNpb24gJiYgIXJlcS5ib2R5LnRhZ3MgJiYgIXJlcS5ib2R5LnByZWNpbykge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiTm8gc2UgZW52aWFyb24gZGF0b3MgYSBtb2RpZmljYXJcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNvZGlnbyA9IHJlcS5wYXJhbXMuY29kaWdvO1xyXG5cclxuICAgIGlmIChjb2RpZ28ubGVuZ3RoICE9IDI0ICYmIGNvZGlnby5sZW5ndGggIT0gMTIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoe1xyXG4gICAgICAgICAgICBtZXNzYWdlOiBcIkNvZGlnbyBpbnZhbGlkb1wiXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUHJvZHVjdG8uZmluZE9uZUFuZFVwZGF0ZSh7IF9pZDogY29kaWdvIH0sIHJlcS5ib2R5LCB7IHVzZUZpbmRBbmRNb2RpZnk6IGZhbHNlLCBuZXc6IHRydWUgfSlcclxuICAgICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFbCBwcm9kdWN0byAke2NvZGlnb30gbm8gZXhpc3RlYFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTW9kaWZpY2FkbycsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0bzogZGF0YVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRXJyb3IgbW9kaWZpY2FuZG8gZWwgcHJvZHVjdG8gJHtjb2RpZ299YCxcclxuICAgICAgICAgICAgICAgIGRiX21lc3NhZ2U6IGVyci5tZXNzYWdlIHx8IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbn07XHJcblxyXG4vLyBFbGltaW5hIHVuIHByb2R1Y3RvIHBvciBzdSBjb2RpZ29cclxuZXhwb3J0cy5kZWxldGUgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IGNvZGlnbyA9IHJlcS5wYXJhbXMuY29kaWdvO1xyXG5cclxuICAgIGlmIChjb2RpZ28ubGVuZ3RoICE9IDI0ICYmIGNvZGlnby5sZW5ndGggIT0gMTIpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoe1xyXG4gICAgICAgICAgICBtZXNzYWdlOiBcIkNvZGlnbyBpbnZhbGlkb1wiXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUHJvZHVjdG8uZmluZE9uZUFuZFJlbW92ZSh7IF9pZDogY29kaWdvIH0pXHJcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRWwgcHJvZHVjdG8gJHtjb2RpZ299IG5vIGV4aXN0ZS5gXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBFbGltaW5hZG9gXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRXJyb3IgYWwgZWxpbWluYXIgZWwgcHJvZHVjdG8gJHtjb2RpZ299YCxcclxuICAgICAgICAgICAgICAgIGRiX21lc3NhZ2U6IGVyci5tZXNzYWdlIHx8IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbn07XHJcblxyXG4vLyBPYnRlbmVyIHRvZG9zIGxvcyBwcm9kdWN0b3NcclxuZXhwb3J0cy5nZXRBbGwgPSAoX3JlcSwgcmVzKSA9PiB7XHJcbiAgICBQcm9kdWN0by5maW5kKHt9KVxyXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oZGF0YSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRXJyb3IgYWwgcmV0b3JuYXIgdG9kb3MgbG9zIHByb2R1Y3RvcyBlbiBsYSBCRFwiLFxyXG4gICAgICAgICAgICAgICAgZGJfbWVzc2FnZTogZXJyLm1lc3NhZ2UgfHwgXCJcIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxufTtcclxuXHJcbi8vIEJ1c2NhciBwcm9kdWN0b1xyXG5leHBvcnRzLmZpbmQgPSAocmVxLCByZXMpID0+IHtcclxuICAgIGlmIChyZXEucXVlcnkuc2VhcmNoID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiTGEgYnVzcXVlZGEgbm8gcHVlZGUgZXN0YXIgdmFjaWFcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29uc3VsdGEgPSByZXEucXVlcnkuc2VhcmNoLnJlcGxhY2UoLyAvZywgXCJ8XCIpXHJcbiAgICAgICAgLnJlcGxhY2UoLywvZywgXCJcIik7XHJcblxyXG4gICAgaWYgKCFjb25zdWx0YSkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiTGEgYnVzcXVlZGEgbm8gcHVlZGUgZXN0YXIgdmFjaWFcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgUHJvZHVjdG8uZmluZCh7XHJcbiAgICAgICAgICAgICRvcjogW3tcclxuICAgICAgICAgICAgICAgIG5vbWJyZToge1xyXG4gICAgICAgICAgICAgICAgICAgICRyZWdleDogY29uc3VsdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgJG9wdGlvbnM6IFwiaVwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIHZlbmRlZG9yOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJlZ2V4OiBjb25zdWx0YSxcclxuICAgICAgICAgICAgICAgICAgICAkb3B0aW9uczogXCJpXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgZGVzY3JpcGNpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAkcmVnZXg6IGNvbnN1bHRhLFxyXG4gICAgICAgICAgICAgICAgICAgICRvcHRpb25zOiBcImlcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBObyBzZSBlbmNvbnRyYXJvbiBwcm9kdWN0b3MgY29uIGxhIGAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBgYnVzcXVlZGEgXCIke2NvbnN1bHRhfVwiYFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkVycm9yIGFsIHJldG9ybmFyIHRvZG9zIGxvcyBwcm9kdWN0b3MgZW4gbGEgQkRcIixcclxuICAgICAgICAgICAgICAgIGRiX21lc3NhZ2U6IGVyci5tZXNzYWdlIHx8IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbn07Il19